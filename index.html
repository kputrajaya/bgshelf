<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Board Game Shelf</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css"
      integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="site.css" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/fast-xml-parser/4.0.12/fxparser.min.js"
      integrity="sha512-HGrrIN/LyGNpsITQqS0Oz+0rCFt/+2/eymCPchz/Pvx8JofaxmLfoEJNIix9R1iHEnScT+HSt8WBifDINQu89g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      defer
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"
      integrity="sha512-JRlcvSZAXT8+5SQQAvklXGJuxXTouyq8oIMaYERZQasB8SBDHZaUbeASsJWpk0UUrf89DP3/aefPPrlMR1h1yQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      defer
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.10.5/cdn.min.js"
      integrity="sha512-y22y4rJ9d7NGoRLII5LVwUv0BfQKf6MpATy5ebVu/fbHdtJCxBpZRHZMHJv8VYl8scWjuwZcMPzwYk4sEoyL4A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      defer
    ></script>
  </head>
  <body class="bg-light">
    <div class="container" x-data="bgs">
      <form class="my-4 d-flex align-center" method="GET">
        <div>
          <div class="input-group input-group-sm">
            <span class="input-group-text">BGG User</span>
            <input
              name="u"
              type="text"
              class="form-control"
              placeholder="Input username..."
              aria-label="Username"
              x-model="username"
              @focus="$event.target.select()"
            />
            <button class="btn btn-primary" type="submit" id="submitBtn">&rarr;</button>
          </div>
        </div>
        <div class="flex-grow-1"></div>
        <div class="flex-shrink-0 col-form-label ps-2 text-end lh-1" x-cloak>
          <span class="spinner-border spinner-border-sm -my-1 ms-3 text-secondary" role="status" x-show="loading">
            <span class="visually-hidden">Loading...</span>
          </span>
          <a
            class="fs-7 text-primary text-decoration-underline"
            :href="'https://boardgamegeek.com/collection/user/' + username"
            target="_blank"
            rel="noreferrer noopener"
            x-show="!loading && items"
          >
            <span x-text="formatNumber(itemsLength())"></span>
            items
          </a>
        </div>
      </form>

      <div x-show="items" x-cloak>
        <div class="mb-4 d-flex">
          <div>
            <div class="input-group input-group-sm">
              <span class="input-group-text">&#128100;</span>
              <select class="form-select" x-model="filter.player">
                <option value="">All player count</option>
                <template x-for="option in filterPlayerOptions()">
                  <option :value="option.value" x-text="option.text"></option>
                </template>
              </select>
            </div>
          </div>
          <div class="ms-3">
            <div class="input-group input-group-sm">
              <span class="input-group-text">&#129504;</span>
              <select class="form-select" x-model="filter.weight">
                <option value="">All weight</option>
                <template x-for="option in filterWeightOptions()">
                  <option :value="option.value" x-text="option.text"></option>
                </template>
              </select>
            </div>
          </div>
          <div class="flex-grow-1"></div>
        </div>

        <div id="wrapper" class="row">
          <template x-for="item in itemsSliced()">
            <div class="col-lg-4 col-md-6 col-12 mb-4">
              <a
                class="card"
                :href="'https://boardgamegeek.com/boardgame/' + item.id"
                target="_blank"
                rel="noreferrer noopener"
              >
                <div class="bg-secondary rounded">
                  <img class="bgs-image rounded" :src="item.image" loading="lazy" />
                </div>
                <div class="card-body">
                  <h5 class="card-title mb-3 align-middle">
                    <span x-html="item.name"></span>
                    <span class="fs-6 text-muted" x-show="item.year">(<span x-text="item.year"></span>)</span>
                  </h5>
                  <div class="card-subtitle text-muted fw-normal">
                    <div class="row">
                      <div class="col-6 mt-1">
                        <span class="me-1" title="Player count">&#128100;</span>
                        <span x-show="item.players.min">
                          <span x-text="formatNumber(item.players.min)"></span
                          ><span x-show="item.players.max > item.players.min"
                            >&ndash;<span x-text="formatNumber(item.players.max)"></span
                          ></span>
                        </span>
                        <span x-show="!item.players.min">-</span>
                      </div>
                      <div class="col-6 mt-1">
                        <span class="me-1" title="BGG rank">&#127942;</span>
                        <span x-show="item.rank" x-text="formatNumber(item.rank)"> </span>
                        <span x-show="!item.rank">-</span>
                      </div>
                      <div class="col-6 mt-1">
                        <span class="me-1" title="Play time">&#128337;</span>
                        <span x-show="item.playTime.min">
                          <span x-text="formatNumber(item.playTime.min)"></span
                          ><span x-show="item.playTime.max > item.playTime.min"
                            >&ndash;<span x-text="formatNumber(item.playTime.max)"></span
                          ></span>
                          min
                        </span>
                        <span x-show="!item.playTime.min">-</span>
                      </div>
                      <div class="col-6 mt-1">
                        <span class="me-1" title="BGG rating">&#127758;</span>
                        <span
                          class="badge text-bg-success fs-7 fw-normal"
                          :class="{ 'text-bg-danger': item.ratingBgg < 6, 'text-bg-warning': item.ratingBgg < 7.5 }"
                          x-text="item.ratingBgg"
                        ></span>
                        (<span x-text="item.ratingBggCount"></span>)
                      </div>
                      <div class="col-6 mt-1">
                        <span class="me-1" title="Weight">&#129504;</span>
                        <span x-show="item.weight" x-text="item.weight"></span>
                        <span x-show="!item.weight">-</span>
                      </div>
                      <div class="col-6 mt-1">
                        <span class="me-1" title="User rating">&#11088;</span>
                        <span
                          class="badge text-bg-success fs-7 fw-normal"
                          :class="{ 'text-bg-danger': item.rating < 6, 'text-bg-warning': item.rating < 7.5 }"
                          x-text="item.rating"
                          x-show="item.rating"
                        ></span>
                        <span x-show="!item.rating">-</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-body border-top" x-show="item.comment">
                  <div class="fs-7 text-muted whitespace-pre-line" x-html="item.comment"></div>
                </div>
              </a>
            </div>
          </template>
        </div>
        <div class="mb-4 fs-7 text-muted" x-show="itemsLength() > limit">
          Showing top <span x-text="formatNumber(limit)"></span> items
        </div>
      </div>
    </div>
    <script src="site.js"></script>
  </body>
</html>
